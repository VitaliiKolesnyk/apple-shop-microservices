{"ast":null,"code":"import { inject } from '@angular/core';\nimport { OidcSecurityService } from \"angular-auth-oidc-client\";\nimport { CommonModule } from '@angular/common';\nimport { Router } from '@angular/router';\nimport { CartService } from '../../services/cart.service';\nimport { RouterModule } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/router\";\nconst _c0 = () => [\"/user-dashboard\"];\nfunction HeaderComponent_ng_container_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"span\", 6);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"a\", 24);\n    i0.ɵɵlistener(\"click\", function HeaderComponent_ng_container_30_Template_a_click_3_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.logout());\n    });\n    i0.ɵɵtext(4, \"Logout\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Welcome, \", ctx_r2.username, \"\");\n  }\n}\nfunction HeaderComponent_ng_template_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 25);\n    i0.ɵɵlistener(\"click\", function HeaderComponent_ng_template_31_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.login());\n    });\n    i0.ɵɵtext(1, \" Login \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let HeaderComponent = /*#__PURE__*/(() => {\n  class HeaderComponent {\n    oidcSecurityService = inject(OidcSecurityService);\n    router = inject(Router);\n    cartService = inject(CartService);\n    isAuthenticated = false;\n    username = \"\";\n    userId = '';\n    ngOnInit() {\n      this.oidcSecurityService.isAuthenticated$.subscribe(({\n        isAuthenticated\n      }) => {\n        this.isAuthenticated = isAuthenticated;\n        this.loadUserId();\n      });\n      this.oidcSecurityService.userData$.subscribe(({\n        userData\n      }) => {\n        this.username = userData.preferred_username;\n      });\n    }\n    loadUserId() {\n      this.oidcSecurityService.getAccessToken().subscribe(token => {\n        const decodedToken = this.decodeToken(token);\n        if (decodedToken && decodedToken.sub) {\n          this.userId = decodedToken.sub; // Assuming 'sub' contains the user ID\n        }\n      });\n    }\n    // Decode JWT token method\n    decodeToken(token) {\n      try {\n        const base64Url = token.split('.')[1];\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n        const jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {\n          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        }).join(''));\n        return JSON.parse(jsonPayload);\n      } catch (error) {\n        console.error('Failed to decode token:', error);\n        return null;\n      }\n    }\n    login() {\n      this.oidcSecurityService.authorize();\n    }\n    logout() {\n      this.oidcSecurityService.logoff().subscribe(result => console.log(result));\n    }\n    // Method to redirect to cart\n    redirectToCart() {\n      if (this.isAuthenticated && this.userId) {\n        this.cartService.getCart(this.userId).subscribe(cart => {\n          this.router.navigate(['/cart']); // Navigate to the cart page after successful fetch\n        }, error => {\n          console.error('Error fetching cart:', error);\n        });\n      } else {\n        console.error('User is not authenticated or user ID is missing');\n      }\n    }\n    static ɵfac = function HeaderComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || HeaderComponent)();\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: HeaderComponent,\n      selectors: [[\"app-header\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 33,\n      vars: 4,\n      consts: [[\"loginTemplate\", \"\"], [1, \"bg-black\", \"text-white\", \"shadow-lg\", \"px-4\", \"sm:px-6\", \"py-4\", \"rounded-md\"], [1, \"container\", \"flex\", \"items-center\", \"mx-auto\"], [\"href\", \"/\", 1, \"flex\", \"items-center\", \"bg-black\", \"text-white\", \"rounded-full\", \"py-2\", \"px-4\", \"shadow-md\", \"transition\", \"duration-300\", \"hover:bg-gray-800\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"fill\", \"none\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", 1, \"h-6\", \"w-6\", \"mr-1\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M3 9l9-6 9 6v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z\"], [1, \"text-lg\"], [1, \"flex\", \"md:hidden\", \"items-center\", \"ml-auto\"], [\"id\", \"menu-toggle\", \"type\", \"button\", 1, \"p-2\", \"text-gray-300\", \"hover:text-white\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-gray-700\", \"rounded-lg\"], [1, \"sr-only\"], [\"fill\", \"none\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", 1, \"h-6\", \"w-6\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M4 6h16M4 12h16m-7 6h7\"], [1, \"flex\", \"flex-grow\", \"items-center\", \"justify-center\", \"space-x-2\"], [1, \"text-lg\", \"font-bold\"], [\"href\", \"/\", 1, \"flex\", \"items-center\"], [\"src\", \"https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ed3d547-94ff-48e1-9f20-8c14a7030a02_2000x2000.jpeg\", \"alt\", \"Shop Logo\", 1, \"custom-logo\"], [1, \"hidden\", \"md:flex\", \"items-center\", \"space-x-8\", \"ml-auto\"], [1, \"flex\", \"items-center\", \"p-3\", \"rounded-lg\", \"bg-black\", \"text-white\", \"hover:bg-gray-800\", \"transition\", \"ease-in-out\", \"duration-200\", 3, \"routerLink\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", \"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"w-5\", \"h-5\", \"mr-2\", \"text-white\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M3 5h18M3 10h18m-7 5h7\"], [1, \"text-lg\", \"font-semibold\"], [1, \"flex\", \"items-center\", \"bg-black\", \"text-white\", \"rounded-full\", \"py-2\", \"px-4\", \"shadow-md\", \"transition\", \"duration-300\", \"hover:bg-gray-800\", 3, \"click\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M3 3h2l1 9h13l1-9h2M3 3L1 1m2 2l1 9h14l1-9H4zm0 0L1 3h2l1 9h13l1-9H4z\"], [4, \"ngIf\", \"ngIfElse\"], [1, \"ml-4\", \"py-2\", \"px-4\", \"bg-red-600\", \"text-white\", \"rounded-full\", \"shadow-md\", \"transition\", \"duration-300\", \"hover:bg-red-700\", 3, \"click\"], [1, \"ml-4\", \"py-2\", \"px-4\", \"bg-white\", \"text-black\", \"rounded-full\", \"shadow-md\", \"transition\", \"duration-300\", \"hover:bg-gray-100\", 3, \"click\"]],\n      template: function HeaderComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"nav\", 1)(1, \"div\", 2)(2, \"a\", 3);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(3, \"svg\", 4);\n          i0.ɵɵelement(4, \"path\", 5);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(5, \"span\", 6);\n          i0.ɵɵtext(6, \"Home\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"div\", 7)(8, \"button\", 8)(9, \"span\", 9);\n          i0.ɵɵtext(10, \"Open menu\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(11, \"svg\", 10);\n          i0.ɵɵelement(12, \"path\", 11);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(13, \"div\", 12)(14, \"span\", 13);\n          i0.ɵɵtext(15, \"Apple Shop\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"a\", 14);\n          i0.ɵɵelement(17, \"img\", 15);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(18, \"div\", 16)(19, \"a\", 17);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(20, \"svg\", 18);\n          i0.ɵɵelement(21, \"path\", 19);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(22, \"span\", 20);\n          i0.ɵɵtext(23, \"Profile\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(24, \"div\", 16)(25, \"button\", 21);\n          i0.ɵɵlistener(\"click\", function HeaderComponent_Template_button_click_25_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.redirectToCart());\n          });\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(26, \"svg\", 4);\n          i0.ɵɵelement(27, \"path\", 22);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(28, \"span\", 6);\n          i0.ɵɵtext(29, \"Cart\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(30, HeaderComponent_ng_container_30_Template, 5, 1, \"ng-container\", 23)(31, HeaderComponent_ng_template_31_Template, 2, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          const loginTemplate_r5 = i0.ɵɵreference(32);\n          i0.ɵɵadvance(19);\n          i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(3, _c0));\n          i0.ɵɵadvance(11);\n          i0.ɵɵproperty(\"ngIf\", ctx.isAuthenticated)(\"ngIfElse\", loginTemplate_r5);\n        }\n      },\n      dependencies: [CommonModule, i1.NgIf, RouterModule, i2.RouterLink],\n      styles: [\".custom-logo[_ngcontent-%COMP%]{height:80px;width:auto}\"]\n    });\n  }\n  return HeaderComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}